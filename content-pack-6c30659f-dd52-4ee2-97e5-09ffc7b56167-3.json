{
  "v": "1",
  "id": "6c30659f-dd52-4ee2-97e5-09ffc7b56167",
  "rev": 3,
  "name": "Symantec Endpoint Protection Manager 14",
  "summary": "Content pack for SEPM 14",
  "description": "This content pack contains a Stream,Pipeline, Pipeline rules, and Grok patterns for SEPM 14.2 and later.",
  "vendor": "connellyt",
  "url": "https://github.com/connellyt/graylog3-sepm-content-pack",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "ce40a4d7-98e0-4e74-876b-f49cdf55c665",
      "data": {
        "name": "MD5hash",
        "pattern": "[a-fA-F0-9]{32}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "e5ec3d2e-1869-4193-a296-1ebe09e798ac",
      "data": {
        "name": "SymantecMAC",
        "pattern": "[A-Fa-f0-9]{12}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "a9c80fe8-a958-4e47-96cd-da50c515178b",
      "data": {
        "name": "SHA256hash",
        "pattern": "[A-Fa-f0-9]{64}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "3694efde-b036-4c4c-80fd-8b4fff812667",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Endpoint Protection"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Endpoint Protection"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Symantec Endpoint Protection\"\nstage 0 match either\nrule \"Symantec Client Logs\"\nrule \"Symantec Traffic Logs\"\nrule \"Symantec Server Logs\"\nrule \"Symantec Device Manager Logs\"\nrule \"Symantec Application Control Logs 1\"\nrule \"Symantec Application Control Logs 2\"\nrule \"SEPM Authentication Events\"\nrule \"Symantec IPS Logs\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "f16b6baf-d013-4f3e-92f7-294d5b4296f3"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f8b4a135-79f7-4546-80a8-7aaa45d2de42",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Application Control Logs 1"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Application Control Logs 1"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Application Control Logs 1\"\r\nwhen\r\n    to_bool(regex(\"Device ID:\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: %{HOSTNAME:local_hostname},(%{IP:local_addr}||%{DATA:UNWANTED})?,%{WORD:action},(- Caller MD5=%{MD5hash:MD5_hash} - Target Arguments=)?%{GREEDYDATA:arguments},%{GREEDYDATA:api_name},Begin:%{GREEDYDATA:start_time},End Time:%{GREEDYDATA:end_time},Rule:(%{GREEDYDATA:rule_name})?,%{INT:ParentProcessID},%{GREEDYDATA:ParentProcess},%{INT:UNWANTED},(%{GREEDYDATA:module_name})?,%{GREEDYDATA:Process},User Name:(%{GREEDYDATA:user_origin})?,Domain Name: (%{GREEDYDATA:domain_origin})?,Action Type: (%{GREEDYDATA:action_type})?,File size \\\\(bytes\\\\): (%{INT:file_size})?,Device ID:( %{GREEDYDATA:device_id})?\",\r\n           to_string($message.message),\r\n           true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "593eda7d-a1bc-4f0c-9081-7e067fd4eb63",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Scan Results"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Scan Results"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Scan Results\"\r\nwhen\r\n    to_bool(regex(\"Scan ID\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: (%{GREEDYDATA:symantec_server})?Scan ID: %{INT:scan_id},Begin: %{GREEDYDATA:start_time},End Time: %{GREEDYDATA:end_time},%{WORD:status},Duration \\\\(seconds\\\\): %{INT:duration},User1: %{WORD:user1},User2: (%{WORD:user2})?,%{GREEDYDATA:event_description},%{GREEDYDATA:result},Command: %{GREEDYDATA:command},Threats: %{INT:threats},Infected: %{INT:infected},Total files: %{INT:files_scanned},Omitted: %{INT:not_scanned},Computer: %{HOSTNAME:src_host},IP Address: %{IP:src_ip},Domain Name: %{GREEDYDATA:domain_origin},Group Name: %{GREEDYDATA:symantec_ou},Server Name: %{HOSTNAME:sepm_server}\",to_string($message.message),true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5ad69c7e-8647-4f48-8a27-165cb7f28b15",
      "data": {
        "title": {
          "@type": "string",
          "@value": "SEPM Authentication Events"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Endpoint Protection Manager Authentication Events"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"SEPM Authentication Events\"\r\nwhen\r\n    to_bool(regex(\"Site:\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: (%{GREEDYDATA:symantec_server})?Site: %{GREEDYDATA:symantec_site},Server Name: %{HOSTNAME:src_hostname}(,Domain Name: %{GREEDYDATA:origin_domain},)?(Admin: %{WORD:user_impacted})?,Event Description: %{GREEDYDATA:event_description}\",to_string($message.message),true        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "99c5aa9f-3a1e-4eec-b3a4-27feef59cdcc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Server Logs"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Server Logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Server Logs\"\r\nwhen\r\n    to_bool(regex(\"Site:\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: (%{GREEDYDATA:symantec_server})?Site: %{GREEDYDATA:symantec_site},Server Name: %{HOSTNAME:local_hostname},(\\\")?Event Description: %{GREEDYDATA:event_description}\",to_string($message.message),true        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c919976a-d79d-47f8-96cd-8e6710ea0daa",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Client Logs"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Client Logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Client Logs\"\r\nwhen\r\n    to_bool(regex(\"\\\\,(Smc||REP||SYLINK||Symantec AntiVirus||Symantec Endpoint Protection||LiveUpdate Manager||Network Intrusion Protection Sys||CVE)\\\\,\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: %{DATA:src_hostname},Category: %{NUMBER:UNWANTED},%{DATA:event_category},Event Description:%{GREEDYDATA:event_description},Event time: %{GREEDYDATA:end_time},Group Name: %{GREEDYDATA:symantec_ou}\",to_string($message.message),true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fe3d4c85-3e4a-4e8d-9fca-e548e00a8e2e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Device Manager Logs"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Device Manager logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Device Manager Logs\"\r\nwhen\r\n    to_bool(regex(\"Device Manager\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: %{HOSTNAME:src_hostname},(\\\")?Event Description: %{GREEDYDATA:event_description}. \\\\[name\\\\]:%{GREEDYDATA:device_name}   \\\\[class\\\\]:%{GREEDYDATA:device_class}   \\\\[guid\\\\]:%{UUID:device_guid}   \\\\[deviceID\\\\]:%{GREEDYDATA:device_id},Local Host IP: %{IP:src_addr},Local Host MAC: %{SymantecMAC:src_mac},Remote Host Name: (%{GREEDYDATA:dest_hostname})?,Remote Host IP: (%{IP:dest_ip})?,Remote Host MAC: (%{SymantecMAC:dest_mac})?,(%{WORD:UNWANTED})?,(%{INT:UNWANTED})?,,Begin: %{GREEDYDATA:start_time},End Time: %{GREEDYDATA:end_time},Occurrences: %{INT:repeat_count},Application: (%{GREEDYDATA:application})?,Location: %{GREEDYDATA:symantec_org},User Name: %{GREEDYDATA:user_origin},Domain Name: %{GREEDYDATA:domain_origin},Local Port: %{INT:src_port},Remote Port: %{INT:dest_port},CIDS Signature ID: %{GREEDYDATA:sig_id1},CIDS Signature string: (%{GREEDYDATA:sig_name})?,CIDS Signature SubID: %{GREEDYDATA:sig_id2},Intrusion URL: (%{GREEDYDATA:intrusion_url})?,Intrusion Payload URL: (%{GREEDYDATA:payload_url})?,SHA-256: (%{SHA256hash:sha256_hash})?,MD-5:(%{MD5hash:md5_hash})?\",\r\n           to_string($message.message),\r\n           true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "e6e2a063-0e92-4db8-812f-df8d42b83229",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Traffic Logs"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Traffic Logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Traffic Logs\"\r\nwhen\r\n    to_bool(regex(\"\\\\(TCP||ICMP||UDP||8\\\\)\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: %{GREEDYDATA:local_hostname},Local Host IP: %{IP:local_addr},Local Port: %{NUMBER:local_port},Local Host MAC: %{SymantecMAC:local_mac},Remote Host IP: %{IP:remote_addr},Remote Host Name: (%{GREEDYDATA:remote_hostname})?,Remote Port: %{NUMBER:remote_port},Remote Host MAC: %{SymantecMAC:remote_mac},(%{DATA:protocol})?,%{WORD:direction},Begin: %{GREEDYDATA:start_time},End Time: %{GREEDYDATA:end_time},Occurrences: %{INT:repeat_count},Application: %{GREEDYDATA:application},Rule: %{GREEDYDATA:rule_name},Location: %{GREEDYDATA:event_location},User Name: %{GREEDYDATA:user_origin},Domain Name: %{GREEDYDATA:domain_origin},Action: %{WORD:action},SHA-256: (%{SHA256hash: sha256_hash})?,MD-5:( %{MD5hash:md5_hash})?\",to_string($message.message),true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c5cab71e-ffed-47af-8368-05e6dfccaece",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec IPS Logs"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec IPS Logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec IPS Logs\"\r\nwhen\r\n    to_bool(regex(\"Intrusion ID\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: %{HOSTNAME:local_hostname},Event Description: %{GREEDYDATA:event_description}. Application path: (%{GREEDYDATA:application_path})?,Local Host IP: %{IP:local_addr},Local Host MAC: %{SymantecMAC:dest_mac},Remote Host Name: (%{GREEDYDATA:remote_hostname})?,Remote Host IP: (%{IP:remote_ip})?,Remote Host MAC: (%{SymantecMAC:remote_mac})?,(%{WORD:direction})?,(%{WORD:protocol})?,Intrusion ID: (%{GREEDYDATA:intrustion_id})?,Begin: %{GREEDYDATA:start_time},End Time: %{GREEDYDATA:end_time},Occurrences: %{INT:repeat_count},Application: (%{GREEDYDATA:application})?,Location: %{GREEDYDATA:symantec_org},User Name: %{GREEDYDATA:user_origin},Domain Name: %{GREEDYDATA:domain_origin},Local Port: %{INT:local_port},Remote Port: %{INT:remote_port},CIDS Signature ID: %{GREEDYDATA:sig_id1},CIDS Signature string: (%{GREEDYDATA:sig_name})?,CIDS Signature SubID: %{GREEDYDATA:sig_id2},Intrusion URL: (%{GREEDYDATA:intrusion_url})?,Intrusion Payload URL: (%{GREEDYDATA:payload_url})?,SHA-256: (%{SHA256hash:sha256_hash})?,MD-5:(%{MD5hash:md5_hash})?\",\r\n           to_string($message.message),\r\n           true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "996b2283-7cca-48ea-bbc8-c87f772d9cb8",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Symantec Application Control Logs 2"
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Application Control Logs 2"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Symantec Application Control Logs 2\"\r\nwhen\r\n    to_bool(regex(\"Device ID:\",to_string($message.message)).matches)\r\nthen\r\n    set_fields(\r\n        grok(\r\n            \"%{HOSTNAME:event_server} SymantecServer: %{HOSTNAME:local_hostname},%{IP:local_addr},%{WORD:action},(%{GREEDYDATA:event_description})?( )?- Caller MD5=%{MD5hash:MD5_hash},%{GREEDYDATA:api_name},Begin:%{GREEDYDATA:start_time},End Time:%{GREEDYDATA:end_time},Rule:(%{GREEDYDATA:rule_name})?,%{INT:ParentProcessID},%{GREEDYDATA:ParentProcess},%{INT:UNWANTED},(%{GREEDYDATA:module_name})?,%{GREEDYDATA:Process},User Name: (%{GREEDYDATA:user_origin})?,Domain Name: (%{GREEDYDATA:domain_origin})?,Action Type: (%{GREEDYDATA:action_type})?,File size \\\\(bytes\\\\): (%{INT:file_size})?,Device ID:( %{GREEDYDATA:device_id})?\",\r\n           to_string($message.message),\r\n           true\r\n        )\r\n    );\r\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "f16b6baf-d013-4f3e-92f7-294d5b4296f3",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "Symantec Endpoint Protection"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "CONTAINS"
            },
            "field": {
              "@type": "string",
              "@value": "message"
            },
            "value": {
              "@type": "string",
              "@value": "SymantecServer"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": "Looks for SymantecServer in message"
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Symantec Endpoint Protection"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.4+1149fe1"
        }
      ]
    }
  ]
}